<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Escuela Sab√°tica - Registro</title>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #f2f2f2;
      color: #333;
      padding: 1rem;
    }

    main {
      max-width: 800px;
      margin: auto;
      background: white;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    h1 {
      text-align: center;
      color: #2c3e50;
      margin-bottom: 0.5rem;
    }

    .subtitulo {
      text-align: center;
      font-size: 0.9rem;
      color: #888;
      margin-bottom: 2rem;
    }

    form {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    label {
      font-weight: bold;
    }

    input[type="number"],
    select {
      padding: 0.5rem;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 5px;
      width: 100%;
      box-sizing: border-box;
    }

    ul {
      list-style: none;
      padding: 0;
    }

    li {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5rem 0;
      border-bottom: 1px solid #ccc;
    }

    button {
      background-color: #2ecc71;
      color: white;
      font-size: 1.2rem;
      padding: 0.8rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 1rem;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: #27ae60;
    }

    #resultado {
      margin-top: 1rem;
      font-weight: bold;
      color: #27ae60;
      text-align: center;
    }
  </style>
</head>
<body>
  <main>
    <h1>Escuela Sab√°tica - Iglesia Central</h1>
    <div class="subtitulo">Desarrollado por : Ministerio ELVIENE.ORG</div>

    <form id="registro-form">
      <div>
        <label for="grupo">Grupo:</label>
        <select id="grupo" required>
          <option value="">Seleccione un grupo</option>
          <option value="Grupo 1">Grupo 1</option>
          <option value="Grupo 2">Grupo 2</option>
          <option value="Grupo 3">Grupo 3</option>
          <option value="Grupo 4">Grupo 4</option>
          <option value="Grupo 5">Grupo 5</option>
        </select>
      </div>

      <div>
        <label>Visitas Misioneras:</label>
        <input type="number" id="visitas" min="0" required>

        <label>Estudios B√≠blicos:</label>
        <input type="number" id="estudios" min="0" required>

        <label>Literaturas Distribuidas:</label>
        <input type="number" id="literatura" min="0" required>

        <label>Personas Auxiliadas:</label>
        <input type="number" id="auxilio" min="0" required>

        <label>Visitas a Enfermos:</label>
        <input type="number" id="enfermos" min="0" required>

        <label>Personas a la Iglesia:</label>
        <input type="number" id="traidas" min="0" required>
      </div>

      <div>
        <label>Hermanos que no asistieron:</label>
        <ul id="lista-hermanos"></ul>
      </div>

      <button type="submit">Registrar y Compartir</button>
    </form>
    <section id="resultado"></section>
  </main>

  <script>
    const hojasGrupo = {
      "Grupo 1": "https://docs.google.com/spreadsheets/d/e/2PACX-1vTval85fAyOcwqmD5etcelAdYqo0a5WsQUP5ZQB0HAuRD1NabKs_hfevFAgOF8r-Yh1CWsgpQfOGxH6/pub?gid=0&single=true&output=csv",
      "Grupo 2": "https://docs.google.com/spreadsheets/d/e/2PACX-1vTval85fAyOcwqmD5etcelAdYqo0a5WsQUP5ZQB0HAuRD1NabKs_hfevFAgOF8r-Yh1CWsgpQfOGxH6/pub?gid=1280824297&single=true&output=csv",
      "Grupo 3": "https://docs.google.com/spreadsheets/d/e/2PACX-1vTval85fAyOcwqmD5etcelAdYqo0a5WsQUP5ZQB0HAuRD1NabKs_hfevFAgOF8r-Yh1CWsgpQfOGxH6/pub?gid=249553127&single=true&output=csv",
      "Grupo 4": "https://docs.google.com/spreadsheets/d/e/2PACX-1vTval85fAyOcwqmD5etcelAdYqo0a5WsQUP5ZQB0HAuRD1NabKs_hfevFAgOF8r-Yh1CWsgpQfOGxH6/pub?gid=1779055312&single=true&output=csv",
      "Grupo 5": "https://docs.google.com/spreadsheets/d/e/2PACX-1vTval85fAyOcwqmD5etcelAdYqo0a5WsQUP5ZQB0HAuRD1NabKs_hfevFAgOF8r-Yh1CWsgpQfOGxH6/pub?gid=1668958024&single=true&output=csv"
    };

    function cargarHermanos(grupo) {
      const url = hojasGrupo[grupo];
      if (!url) return;

      fetch(url)
        .then(res => res.text())
        .then(data => {
          const lineas = data.split("\n").slice(1);
          const lista = document.getElementById("lista-hermanos");
          lista.innerHTML = "";

          lineas.forEach(linea => {
            const nombre = linea.trim();
            if (nombre) {
              const li = document.createElement("li");
              li.innerHTML = \`
                <label style="display:flex; justify-content:space-between; align-items:center;">
                  \${nombre}
                  <input type="checkbox" value="\${nombre}" />
                </label>
              \`;
              lista.appendChild(li);
            }
          });
        });
    }

    document.getElementById("grupo").addEventListener("change", function () {
      cargarHermanos(this.value);
    });

    document.getElementById("registro-form").addEventListener("submit", function (e) {
      e.preventDefault();

      const grupo = document.getElementById('grupo').value;
      const visitas = document.getElementById('visitas').value;
      const estudios = document.getElementById('estudios').value;
      const literatura = document.getElementById('literatura').value;
      const auxilio = document.getElementById('auxilio').value;
      const enfermos = document.getElementById('enfermos').value;
      const traidas = document.getElementById('traidas').value;

      const faltantes = [...document.querySelectorAll('#lista-hermanos input:checked')]
        .map(cb => cb.value)
        .join(', ');

      const mensaje = \`üìã *Reporte Escuela Sab√°tica - \${grupo}*\n\n‚û°Ô∏è Visitas Misioneras: \${visitas}\nüìñ Estudios B√≠blicos: \${estudios}\nüìö Literatura Distribuida: \${literatura}\nü´Ç Personas Auxiliadas: \${auxilio}\nüè• Visitas a Enfermos: \${enfermos}\nüè† Personas a la Iglesia: \${traidas}\nüö´ No asistieron: \${faltantes || 'Ninguno'}\`;

      const whatsappURL = \`https://wa.me/?text=\${encodeURIComponent(mensaje)}\`;
      window.open(whatsappURL, '_blank');

      document.getElementById('resultado').innerText = '¬°Registro enviado a WhatsApp!';
      this.reset();
      document.getElementById("lista-hermanos").innerHTML = "";
    });
  </script>
</body>
</html>